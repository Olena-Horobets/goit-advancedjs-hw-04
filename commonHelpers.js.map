{"version":3,"file":"commonHelpers.js","sources":["../src/js/refs.js","../src/js/fetchApi.js","../src/js/galleryMarkup.js","../src/main.js"],"sourcesContent":["export default {\n  body: document.querySelector('body'),\n\n  searchForm: document.querySelector('#search-form'),\n  resetBtn: document.querySelector('[data-action=\"reset\"]'),\n  loadMoreBtn: document.querySelector('[data-action=\"load-more\"]'),\n  gallery: document.querySelector('#gallery'),\n  message: document.querySelector('.reqest-message'),\n};\n","class SearchAPIData {\n  #BASE_URL;\n  #API_KEY;\n\n  constructor({ url, key, perPage }) {\n    this.#BASE_URL = url;\n    this.#API_KEY = key;\n    this._searcQuery = '';\n    this.page = 1;\n    this.perPage = perPage;\n  }\n\n  set searcQuery(value) {\n    this._searcQuery = value;\n  }\n\n  setNextPage() {\n    this.page += 1;\n  }\n\n  resetPage() {\n    this.page = 1;\n  }\n\n  getBasicFetchUrl() {\n    return `${this.#BASE_URL}?key=${this.#API_KEY}&q=${this._searcQuery}&page=${\n      this.page\n    }`;\n  }\n}\n\nclass SearchPhotoData extends SearchAPIData {\n  constructor({ url, key, perPage, imageType, orientation, safesearch }) {\n    super({ url, key, perPage });\n    this.imageType = imageType;\n    this.orientation = orientation;\n    this.safesearch = safesearch;\n  }\n\n  getFetchUrl() {\n    const url = `${this.getBasicFetchUrl()}&per_page=${\n      this.perPage\n    }&image_type=${this.imageType}&orientation=${this.orientation}&safesearch=${\n      this.safesearch\n    }`;\n    return url;\n  }\n}\n\nconst photoFinderOptions = {\n  url: 'https://pixabay.com/api/',\n  key: '22936688-6b3396d854cca2c3f8d0c7d41',\n  perPage: 40,\n  imageType: 'photo',\n  orientation: 'horizontal',\n  safesearch: true,\n};\n\nconst photoFinder = new SearchPhotoData({ ...photoFinderOptions });\nexport default photoFinder;\n","export default function galleryItemTpl(arr) {\n  return arr\n    .map(el => {\n      return `<li class=\"gallery-card\" href=\"${el.largeImageURL}\">\n  <img\n    class=\"gallery-card__img\"\n    src=\"${el.webformatURL}\"\n    alt=\"${el.tags}\"\n    loading=\"lazy\"\n    id=\"${el.id}\"\n    data-src=\"${el.largeImageURL}\"\n  />\n\n  <div class=\"info\">\n    <div class=\"info__thumb\">\n      <p class=\"info-item\">\n        <span>${el.likes}</span>\n        <span class=\"material-icons\">favorite</span>\n      </p>\n      <p class=\"info-item\">\n        <span>${el.views}</span>\n        <span class=\"material-icons\">visibility</span>\n      </p>\n      <p class=\"info-item\">\n        <span>${el.comments}</span>\n        <span class=\"material-icons\">textsms</span>\n      </p>\n      <p class=\"info-item\">\n        <span>${el.downloads}</span>\n        <span class=\"material-icons\">cloud_download</span>\n      </p>\n    </div>\n\n    <div class=\"blur\" style=\"background-image: url(${el.webformatURL})\"></div>\n  </div>\n</li>`;\n    })\n    .join('');\n}\n","import refs from './js/refs.js';\nimport photoFinder from './js/fetchApi.js';\nimport galleryItemTpl from './js/galleryMarkup.js';\n\nrefs.searchForm.addEventListener('submit', onSearch);\nrefs.searchForm.addEventListener('input', e => {\n  refs.resetBtn.disabled = false;\n  refs.resetBtn.addEventListener('click', onReset, { once: true });\n});\n\nfunction onSearch(e) {\n  e.preventDefault();\n  console.log('loading');\n\n  const value = e.currentTarget.elements.searchQuery.value.trim();\n  if (value === '') {\n    onServerResponse('Please, enter valid query!');\n    return;\n  }\n\n  try {\n    refs.resetBtn.disabled = false;\n    refs.resetBtn.addEventListener('click', onReset, { once: true });\n    refs.message.classList.add('is-hidden');\n    onNewFetch(value);\n    fetchAndRender();\n  } catch (err) {\n    onServerResponse('Please, enter valid query!');\n  }\n}\n\nfunction onServerResponse(message) {\n  //   Loading.remove();\n  console.log(message);\n}\n\nfunction onMarkupRender(list) {\n  refs.gallery.insertAdjacentHTML('beforeend', list);\n}\n\nasync function fetchAndRender() {\n  console.log('loading');\n\n  await fetch(photoFinder.getFetchUrl())\n    .then(res => res.json())\n    .then(data => {\n      if (data.totalHits === 0) {\n        onServerResponse(`Sorry, we couldn't find anything for you(`);\n        onReset();\n        return;\n      }\n      if (data.hits.length < photoFinder.perPage) {\n        onServerResponse(\n          `This was all we had for you, try something else, please`\n        );\n        refs.loadMoreBtn.classList.add('is-hidden');\n        refs.loadMoreBtn.removeEventListener('click', fetchAndRender);\n        try {\n          onMarkupRender(galleryItemTpl(data.hits));\n          smoothScrollingTo(String(data.hits[0].id));\n          return;\n        } catch (err) {\n          onServerResponse('Please, enter valid query!');\n        }\n      }\n\n      if (photoFinder.page === 1) {\n        onServerResponse(`Hooray! We found ${data.totalHits} images.`);\n      }\n\n      onMarkupRender(galleryItemTpl(data.hits));\n      smoothScrollingTo(String(data.hits[0].id));\n      photoFinder.setNextPage();\n      console.log('loading remove');\n      refs.loadMoreBtn.classList.remove('is-hidden');\n      refs.loadMoreBtn.addEventListener('click', fetchAndRender);\n\n      //   modal.srcList = data.hits;\n      //   refs.gallery.addEventListener('click', modal.onModalOpen.bind(modal));\n    });\n}\n\nfunction onNewFetch(value = '') {\n  photoFinder.searcQuery = value;\n  photoFinder.resetPage();\n  refs.gallery.innerHTML = '';\n\n  refs.loadMoreBtn.classList.add('is-hidden');\n  refs.loadMoreBtn.removeEventListener('click', fetchAndRender);\n}\n\nfunction onReset() {\n  refs.searchForm.elements.query.value = '';\n  onNewFetch();\n  refs.message.classList.remove('is-hidden');\n  refs.resetBtn.disabled = true;\n}\n\nfunction smoothScrollingTo(id) {\n  const element = document.getElementById(id);\n  element.scrollIntoView({\n    alignToTop: true,\n    behavior: 'smooth',\n    block: 'center',\n  });\n}\n"],"names":["refs","SearchAPIData","url","key","perPage","__privateAdd","_BASE_URL","_API_KEY","__privateSet","value","__privateGet","SearchPhotoData","imageType","orientation","safesearch","photoFinderOptions","photoFinder","galleryItemTpl","arr","el","onSearch","onReset","onServerResponse","onNewFetch","fetchAndRender","message","onMarkupRender","list","res","data","smoothScrollingTo","id"],"mappings":"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"}